<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> kali linux 2016 使用指南(二) · Z3R0YU</title><meta name="description" content="kali linux 2016 使用指南(二) - z3r0yu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://zer0yu.github.io/atom.xml" title="Z3R0YU"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/Z3r0yu" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/zer0yu" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">kali linux 2016 使用指南(二)</h1><div class="post-info">Jan 21, 2017</div><div class="post-content"><h4 id="虚拟机安装增强"><a href="#虚拟机安装增强" class="headerlink" title="虚拟机安装增强"></a>虚拟机安装增强</h4><h5 id="1-Kali-官方安装"><a href="#1-Kali-官方安装" class="headerlink" title="1.Kali 官方安装"></a>1.Kali 官方安装</h5><p>更新 /etc/apt/sources.list</p>
<p>你所添加的源，请确保是我在一中写的所有</p>
<p>然后在线安装增强功能</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">apt-get update</div><div class="line"></div><div class="line">apt-get install -y virtualbox-guest-x11</div><div class="line"></div><div class="line">reboot</div></pre></td></tr></table></figure>
<h5 id="2-VirtualBox自带包安装"><a href="#2-VirtualBox自带包安装" class="headerlink" title="2.VirtualBox自带包安装"></a>2.VirtualBox自带包安装</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">apt-get update &amp;&amp; apt-get install -y linux-headers-$(uname-r)</div><div class="line"></div><div class="line">cp /media/cd-rom/VBoxLinuxAdditions.run /root/</div><div class="line"></div><div class="line">chmod 755 /root/VBoxLinuxAdditions.run</div><div class="line"></div><div class="line">cd/root</div><div class="line"></div><div class="line">./VBoxLinuxAdditions.run</div></pre></td></tr></table></figure>
<h4 id="内核头有问题自己手动安装过程"><a href="#内核头有问题自己手动安装过程" class="headerlink" title="内核头有问题自己手动安装过程"></a>内核头有问题自己手动安装过程</h4><p>打开 <a href="http://http.kali.org/kali/pool/main/l/linux/%20" target="_blank" rel="external">http://http.kali.org/kali/pool/main/l/linux/</a></p>
<p>下载对应自己内核版本的 linux-kbuild</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">wget http://http.kali.org/kali/pool/main/l/linux/linux-kbuild-4.6_4.6.4-1kali1_amd64.deb</div><div class="line"></div><div class="line">dpkg -i linux-kbuild-4.6_4.6.4-1kali1_amd64.deb</div><div class="line"></div><div class="line">wget http://http.kali.org/kali/pool/main/l/linux/linux-headers-4.6.0-kali1-common_4.6.4-1kali1_amd64.deb</div><div class="line"></div><div class="line">wget http://http.kali.org/kali/pool/main/l/linux/http://http.kali.org/kali/pool/main/l/linux/linux-headers-4.6.0-kali1-amd64_4.6.4-1kali1_amd64.deb</div><div class="line"></div><div class="line">dpkg -i linux-headers-4.6.0-kali1-common_4.6.4-1kali1_amd64.deb</div><div class="line"></div><div class="line">dpkg -i linux-headers-4.6.0-kali1-amd64_4.6.4-1kali1_amd64.deb</div><div class="line"></div><div class="line">apt-get -f install</div></pre></td></tr></table></figure>
<h4 id="开启SSH服务"><a href="#开启SSH服务" class="headerlink" title="开启SSH服务"></a>开启SSH服务</h4><p>首先：编辑sshd_config文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim /etc/ssh/sshd_config</div></pre></td></tr></table></figure>
<p>其次：将sshd_config文件中的语句PermitRootLogin prohibit-password修改为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PermitRootLogin yes</div></pre></td></tr></table></figure>
<p>再次：使用命令启动SSH服务:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/etc/init.d/ssh start</div><div class="line"># 或者</div><div class="line">service ssh start</div></pre></td></tr></table></figure>
<p>最后：设置系统开机自动启动SSH服务:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">update-rc.d ssh enable  //系统自动启动SSH服务</div></pre></td></tr></table></figure>
<h4 id="mysql重置密码"><a href="#mysql重置密码" class="headerlink" title="mysql重置密码"></a>mysql重置密码</h4><p>1、如果<a href="http://lib.csdn.net/base/linux" target="_blank" rel="external">Linux</a>中未安装<a href="http://lib.csdn.net/base/mysql" target="_blank" rel="external">MySQL</a>，则需要下载安装，<strong>在安装的过程中会要求输入用户名密码</strong>，则无需重置，直接设置</p>
<p>2、MySQL设置UTF-8编码格式**</p>
<p>配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@kali:~# vim /etc/mysql/my.cnf</div></pre></td></tr></table></figure>
<p>添加默认utf-8编码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[client]</div><div class="line">default-character-set = utf8</div><div class="line">[mysqld]</div><div class="line">default-storage-engine = INNODB</div><div class="line">character-set-server = utf8</div><div class="line">collation-server = utf8_general_ci</div></pre></td></tr></table></figure>
<p>3、更新MySQL的用户名密码</p>
<p>首先查看MySQL是否运行，确保MySQL是stop状态，可以使用/etc/init.d/mysql stop停止运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root@kali:~# /etc/init.d/mysql status</div><div class="line">[info] MySQL is stopped..</div></pre></td></tr></table></figure>
<p>然后启动MySQL的server/daemon process</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@kali:~# mysqld_safe –skip-grant-tables &amp;</div></pre></td></tr></table></figure>
<p>使用root用户连接MySQL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">root@kali:~# mysql -u root</div><div class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line">Your MySQL connection id is 1</div><div class="line">Server version: 5.5.44–0+deb7u1 (Debian)</div><div class="line">Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.</div><div class="line">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line">affiliates. Other names may be trademarks of their respective</div><div class="line">owners.</div><div class="line">Type ‘help;’ or ‘\h’ for help. Type ‘\c’ to clear the current input statement.</div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
<p>更改root用户的密码为admin</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; use mysql</div><div class="line">Reading table information for completion of table and column names</div><div class="line">You can turn off this feature to get a quicker startup with -A</div><div class="line">Database changed</div><div class="line">mysql&gt; update user set password=PASSWORD(‘admin’) where User=‘root’;</div><div class="line">Query OK, 4 rows affected (0.01 sec)</div><div class="line">Rows matched: 4  Changed: 4  Warnings: 0</div></pre></td></tr></table></figure>
<p>执行更新命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; flush privileges;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure>
<p>flush privileges 命令本质上的作用是将当前user和privilige表中的用户信息/权限设置从mysql库(MySQL数据库的内置库)中提取到内存里。MySQL用户数据和权限有修改后，希望在”不重启MySQL服务”的情况下直接生效，那么就需要执行这个命令。通常是在修改ROOT帐号的设置后，怕重启后无法再登录进来，那么直接flush之后就可以看权限设置是否生效。而不必冒太大风险。</p>
<p>退出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; quit</div></pre></td></tr></table></figure>
<p>4、验证用户密码是否更新成功</p>
<p>重启MySQL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">root@kali:~# /etc/init.d/mysql restart</div><div class="line">[ ok ] Stopping MySQL database server: mysqld.</div><div class="line">[….] Starting MySQL database server: mysqld151015 11:41:36 mysqld_safe mysqld from pid file /var/run/mysqld/mysqld.pid ended</div><div class="line">[ .k</div><div class="line">[info] Checking for tables which need an upgrade, are corrupt or were</div><div class="line">not closed cleanly..</div><div class="line">[1]+  完成                  mysqld_safe –skip-grant-tables</div></pre></td></tr></table></figure>
<p>使用root用户连接MySQL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">root@kali:~# mysql -u root -p</div><div class="line">Enter password:</div><div class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line">Your MySQL connection id is 43</div><div class="line">Server version: 5.5.44–0+deb7u1 (Debian)</div><div class="line">Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.</div><div class="line">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line">affiliates. Other names may be trademarks of their respective</div><div class="line">owners.</div><div class="line">Type ‘help;’ or ‘\h’ for help. Type ‘\c’ to clear the current input statement.</div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
<h4 id="metasploit-Database-not-connect问题解决"><a href="#metasploit-Database-not-connect问题解决" class="headerlink" title="metasploit Database not connect问题解决"></a>metasploit Database not connect问题解决</h4><p>1、postgresql是本身没有启动的。所以需要启动。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">service postgresql start</div></pre></td></tr></table></figure>
<p>2、通过命令进入配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo -u postgres psql</div><div class="line">ALTER USER postgres WITH PASSWORD ‘123.com’;</div></pre></td></tr></table></figure>
<p>注意1：‘123.com’这个是密码。<br>注意2：分号！！！！一定要带上分号“；”。<br>注意3：\q：退出数据库</p>
<p>3、修改linux系统的postgres用户的密码（密码与数据库用户postgres的密码相同）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">root@kali:~# sudo passwd -d postgres</div><div class="line">passwd：密码过期信息已更改。</div><div class="line">root@kali:~# sudo -u postgres passwd</div><div class="line">输入新的 UNIX 密码：</div><div class="line">重新输入新的 UNIX 密码：</div><div class="line">passwd：已成功更新密码</div></pre></td></tr></table></figure>
<p>4、修改PostgresSQL数据库配置实现远程访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">root@kali:~# vi /etc/postgresql/9.4/main/postgresql.conf</div><div class="line">更改#listen_addresses = ‘localhost’为 listen_addresses = ‘*’</div><div class="line">更改#password_encryption = on为password_encryption = on</div><div class="line">root@kali:~# vi /etc/postgresql/9.4/main/pg_hba.conf</div><div class="line">在文档末尾加上以下内容</div><div class="line"># to allow your client visiting postgresql server</div><div class="line">host all all 0.0.0.0 0.0.0.0 md5</div><div class="line">root@kali:~# service postgresql restart</div></pre></td></tr></table></figure>
<p>注意1：“#”号，一定要把“#”删除掉。<br>注意2：在vi编辑模式下点击键盘字母a是进入编辑模式，编辑完成后点击“esc”退出编辑模式然后在最下方输入“：wq”保存并退出。</p>
<p>5、管理PostgreSQL用户和数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@kali:~# psql -U postgres -h 127.0.0.1</div></pre></td></tr></table></figure>
<p>用户 postgres 的口令：<br>psql (9.4.6)<br>SSL连接 (协议: TLSv1.2, 加密：ECDHE-RSA-AES256-GCM-SHA384，二进制位: 256, 压缩比: 关闭)<br>输入 “help” 来获取帮助信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">postgres=# create user “msf123” with password ‘123456’ nocreatedb;</div><div class="line">CREATE ROLE</div><div class="line">postgres=# create database “msf1” with owner=”msf123”;</div><div class="line">ERROR: role “”msf123”” does not exist</div><div class="line">postgres=# create database “msf1″ with owner=”msf123”;</div><div class="line">CREATE DATABASE</div><div class="line">postgres=# \q</div></pre></td></tr></table></figure>
<p>注意1：还是要注意分号！！！没有分号命令就无法执行。<br>注意2：注意复制的时候“”符号问题。<br>注意3：user后面是用户名，password后面是用户名对应的密码。<br>注意4：命令执行后有返回结果才是执行成功了。</p>
<p>6、msf配置连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">root@kali:~# msfconsole</div><div class="line">msf &gt; db_status</div><div class="line">[*] postgresql selected, no connection</div><div class="line">msf &gt; db_connect msf123:123456@127.0.0.1/msf1</div><div class="line">[*] Rebuilding the module cache in the background…</div><div class="line">msf &gt; db_status</div><div class="line">[*] postgresql connected to msf1</div><div class="line">msf &gt;</div></pre></td></tr></table></figure>
<p>在msf启动后连接数据库就好。<br>注意1：“msf123:123456”这个是步骤5中的<br>“create user “msf123” with password ‘123456’ nocreatedb;”所建立的。<br>“127.0.0.1”是指本机。<br>“msf1”这个是库名。<br>注意2：“[*] postgresql connected to msf1”这个是说明以链接成功数据库。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/01/21/基于CSI的移动目标侦测研究学习/" class="prev">上一篇</a><a href="/2017/01/21/kali-linux-2016-使用指南-一/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2018 <a href="http://zer0yu.github.io">z3r0yu</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>